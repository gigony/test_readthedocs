
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>monai.transforms.utility.array &#8212; MONAI 0.6.0 Documentation</title>
    
  <link href="../../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css" />
    
  <link rel="preload" as="script" href="../../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../../../index.html">
  <img src="../../../../_static/MONAI-logo-color.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../whatsnew.html">
  Whatâ€™s New
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../highlights.html">
  Modules Overview
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../api.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../installation.html">
  Installation Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../contrib.html">
  Development
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/Project-MONAI/tutorials">Tutorials<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/project-monai/monai" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/projectmonai" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <h1>Source code for monai.transforms.utility.array</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2020 - 2021 MONAI Consortium</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A collection of &quot;vanilla&quot; transforms for utility functions</span>
<span class="sd">https://github.com/Project-MONAI/MONAI/wiki/MONAI_Design</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="kn">from</span> <span class="nn">monai.config</span> <span class="kn">import</span> <span class="n">DtypeLike</span><span class="p">,</span> <span class="n">NdarrayTensor</span>
<span class="kn">from</span> <span class="nn">monai.transforms.transform</span> <span class="kn">import</span> <span class="n">Randomizable</span><span class="p">,</span> <span class="n">Transform</span>
<span class="kn">from</span> <span class="nn">monai.transforms.utils</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">convert_to_numpy</span><span class="p">,</span>
    <span class="n">convert_to_tensor</span><span class="p">,</span>
    <span class="n">extreme_points_to_image</span><span class="p">,</span>
    <span class="n">get_extreme_points</span><span class="p">,</span>
    <span class="n">map_binary_to_indices</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">monai.utils</span> <span class="kn">import</span> <span class="n">ensure_tuple</span><span class="p">,</span> <span class="n">issequenceiterable</span><span class="p">,</span> <span class="n">min_version</span><span class="p">,</span> <span class="n">optional_import</span>

<span class="n">PILImageImage</span><span class="p">,</span> <span class="n">has_pil</span> <span class="o">=</span> <span class="n">optional_import</span><span class="p">(</span><span class="s2">&quot;PIL.Image&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Image&quot;</span><span class="p">)</span>
<span class="n">pil_image_fromarray</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">optional_import</span><span class="p">(</span><span class="s2">&quot;PIL.Image&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;fromarray&quot;</span><span class="p">)</span>
<span class="n">cp</span><span class="p">,</span> <span class="n">has_cp</span> <span class="o">=</span> <span class="n">optional_import</span><span class="p">(</span><span class="s2">&quot;cupy&quot;</span><span class="p">)</span>
<span class="n">cp_ndarray</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">optional_import</span><span class="p">(</span><span class="s2">&quot;cupy&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ndarray&quot;</span><span class="p">)</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Identity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AsChannelFirst&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AsChannelLast&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AddChannel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;EnsureChannelFirst&quot;</span><span class="p">,</span>
    <span class="s2">&quot;EnsureType&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RepeatChannel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RemoveRepeatedChannel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SplitChannel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CastToType&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ToTensor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ToNumpy&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ToPIL&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Transpose&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SqueezeDim&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DataStats&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SimulateDelay&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Lambda&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LabelToMask&quot;</span><span class="p">,</span>
    <span class="s2">&quot;FgBgToIndices&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ConvertToMultiChannelBasedOnBratsClasses&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AddExtremePointsChannel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TorchVision&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MapLabelValue&quot;</span><span class="p">,</span>
<span class="p">]</span>


<div class="viewcode-block" id="Identity"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.Identity">[docs]</a><span class="k">class</span> <span class="nc">Identity</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert the input to an np.ndarray, if input data is np.ndarray or subclasses, return unchanged data.</span>
<span class="sd">    As the output value is same as input, it can be used as a testing tool to verify the transform chain,</span>
<span class="sd">    Compose or transform adaptor, etc.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Identity.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.Identity.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the transform to `img`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="AsChannelFirst"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.AsChannelFirst">[docs]</a><span class="k">class</span> <span class="nc">AsChannelFirst</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Change the channel dimension of the image to the first dimension.</span>

<span class="sd">    Most of the image transformations in ``monai.transforms``</span>
<span class="sd">    assume the input image is in the channel-first format, which has the shape</span>
<span class="sd">    (num_channels, spatial_dim_1[, spatial_dim_2, ...]).</span>

<span class="sd">    This transform could be used to convert, for example, a channel-last image array in shape</span>
<span class="sd">    (spatial_dim_1[, spatial_dim_2, ...], num_channels) into the channel-first format,</span>
<span class="sd">    so that the multidimensional image array can be correctly interpreted by the other transforms.</span>

<span class="sd">    Args:</span>
<span class="sd">        channel_dim: which dimension of input image is the channel, default is the last dimension.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">channel_dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">channel_dim</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;invalid channel dimension.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel_dim</span> <span class="o">=</span> <span class="n">channel_dim</span>

<div class="viewcode-block" id="AsChannelFirst.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.AsChannelFirst.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the transform to `img`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_dim</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="AsChannelLast"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.AsChannelLast">[docs]</a><span class="k">class</span> <span class="nc">AsChannelLast</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Change the channel dimension of the image to the last dimension.</span>

<span class="sd">    Some of other 3rd party transforms assume the input image is in the channel-last format with shape</span>
<span class="sd">    (spatial_dim_1[, spatial_dim_2, ...], num_channels).</span>

<span class="sd">    This transform could be used to convert, for example, a channel-first image array in shape</span>
<span class="sd">    (num_channels, spatial_dim_1[, spatial_dim_2, ...]) into the channel-last format,</span>
<span class="sd">    so that MONAI transforms can construct a chain with other 3rd party transforms together.</span>

<span class="sd">    Args:</span>
<span class="sd">        channel_dim: which dimension of input image is the channel, default is the first dimension.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">channel_dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">channel_dim</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;invalid channel dimension.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel_dim</span> <span class="o">=</span> <span class="n">channel_dim</span>

<div class="viewcode-block" id="AsChannelLast.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.AsChannelLast.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the transform to `img`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_dim</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="AddChannel"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.AddChannel">[docs]</a><span class="k">class</span> <span class="nc">AddChannel</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a 1-length channel dimension to the input image.</span>

<span class="sd">    Most of the image transformations in ``monai.transforms``</span>
<span class="sd">    assumes the input image is in the channel-first format, which has the shape</span>
<span class="sd">    (num_channels, spatial_dim_1[, spatial_dim_2, ...]).</span>

<span class="sd">    This transform could be used, for example, to convert a (spatial_dim_1[, spatial_dim_2, ...])</span>
<span class="sd">    spatial image into the channel-first format so that the</span>
<span class="sd">    multidimensional image array can be correctly interpreted by the other</span>
<span class="sd">    transforms.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="AddChannel.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.AddChannel.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">NdarrayTensor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the transform to `img`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">img</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="EnsureChannelFirst"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.EnsureChannelFirst">[docs]</a><span class="k">class</span> <span class="nc">EnsureChannelFirst</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Automatically adjust or add the channel dimension of input data to ensure `channel_first` shape.</span>
<span class="sd">    It extracts the `original_channel_dim` info from provided meta_data dictionary.</span>
<span class="sd">    Typical values of `original_channel_dim` can be: &quot;no_channel&quot;, 0, -1.</span>
<span class="sd">    Convert the data to `channel_first` based on the `original_channel_dim` information.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="EnsureChannelFirst.__init__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.EnsureChannelFirst.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strict_check</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            strict_check: whether to raise an error when the meta information is insufficient.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">strict_check</span> <span class="o">=</span> <span class="n">strict_check</span></div>

<div class="viewcode-block" id="EnsureChannelFirst.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.EnsureChannelFirst.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">meta_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the transform to `img`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">meta_dict</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;meta_dict not available, EnsureChannelFirst is not in use.&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict_check</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">img</span>

        <span class="n">channel_dim</span> <span class="o">=</span> <span class="n">meta_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;original_channel_dim&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">channel_dim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Unknown original_channel_dim in the meta_dict, EnsureChannelFirst is not in use.&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict_check</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">img</span>
        <span class="k">if</span> <span class="n">channel_dim</span> <span class="o">==</span> <span class="s2">&quot;no_channel&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">AddChannel</span><span class="p">()(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">AsChannelFirst</span><span class="p">(</span><span class="n">channel_dim</span><span class="o">=</span><span class="n">channel_dim</span><span class="p">)(</span><span class="n">img</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="RepeatChannel"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.RepeatChannel">[docs]</a><span class="k">class</span> <span class="nc">RepeatChannel</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Repeat channel data to construct expected input shape for models.</span>
<span class="sd">    The `repeats` count includes the origin data, for example:</span>
<span class="sd">    ``RepeatChannel(repeats=2)([[1, 2], [3, 4]])`` generates: ``[[1, 2], [1, 2], [3, 4], [3, 4]]``</span>

<span class="sd">    Args:</span>
<span class="sd">        repeats: the number of repetitions for each element.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">repeats</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">repeats</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;repeats count must be greater than 0.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repeats</span> <span class="o">=</span> <span class="n">repeats</span>

<div class="viewcode-block" id="RepeatChannel.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.RepeatChannel.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the transform to `img`, assuming `img` is a &quot;channel-first&quot; array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeats</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></div></div>


<span class="k">class</span> <span class="nc">RemoveRepeatedChannel</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    RemoveRepeatedChannel data to undo RepeatChannel</span>
<span class="sd">    The `repeats` count specifies the deletion of the origin data, for example:</span>
<span class="sd">    ``RemoveRepeatedChannel(repeats=2)([[1, 2], [1, 2], [3, 4], [3, 4]])`` generates: ``[[1, 2], [3, 4]]``</span>

<span class="sd">    Args:</span>
<span class="sd">        repeats: the number of repetitions to be deleted for each element.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">repeats</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">repeats</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;repeats count must be greater than 0.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">repeats</span> <span class="o">=</span> <span class="n">repeats</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the transform to `img`, assuming `img` is a &quot;channel-first&quot; array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">img</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;Image must have more than one channel&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="p">[::</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeats</span><span class="p">,</span> <span class="p">:])</span>


<div class="viewcode-block" id="SplitChannel"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.SplitChannel">[docs]</a><span class="k">class</span> <span class="nc">SplitChannel</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Split Numpy array or PyTorch Tensor data according to the channel dim.</span>
<span class="sd">    It can help applying different following transforms to different channels.</span>

<span class="sd">    Args:</span>
<span class="sd">        channel_dim: which dimension of input image is the channel, default to 0.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel_dim</span> <span class="o">=</span> <span class="n">channel_dim</span>

<div class="viewcode-block" id="SplitChannel.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.SplitChannel.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]:</span>
        <span class="n">n_classes</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_dim</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">n_classes</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;input image does not contain multiple channels.&quot;</span><span class="p">)</span>

        <span class="n">outputs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">slices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_classes</span><span class="p">):</span>
            <span class="n">slices</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_dim</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">outputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">slices</span><span class="p">)])</span>

        <span class="k">return</span> <span class="n">outputs</span></div></div>


<div class="viewcode-block" id="CastToType"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.CastToType">[docs]</a><span class="k">class</span> <span class="nc">CastToType</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cast the Numpy data to specified numpy data type, or cast the PyTorch Tensor to</span>
<span class="sd">    specified PyTorch data type.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CastToType.__init__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.CastToType.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            dtype: convert image to this data type, default is `np.float32`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span></div>

<div class="viewcode-block" id="CastToType.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.CastToType.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">DtypeLike</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the transform to `img`, assuming `img` is a numpy array or PyTorch Tensor.</span>

<span class="sd">        Args:</span>
<span class="sd">            dtype: convert image to this data type, default is `self.dtype`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When ``img`` type is not in ``Union[numpy.ndarray, torch.Tensor]``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dtype</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dtype</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;img must be one of (numpy.ndarray, torch.Tensor) but is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ToTensor"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.ToTensor">[docs]</a><span class="k">class</span> <span class="nc">ToTensor</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the input image to a tensor without applying any other transformations.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ToTensor.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.ToTensor.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the transform to `img` and make it contiguous.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">contiguous</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">issequenceiterable</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
            <span class="c1"># numpy array with 0 dims is also sequence iterable</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">img</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="c1"># `ascontiguousarray` will add 1 dim if img has no dim, so we only apply on data with dims</span>
                <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">img</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="EnsureType"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.EnsureType">[docs]</a><span class="k">class</span> <span class="nc">EnsureType</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensure the input data to be a PyTorch Tensor or numpy array, support: `numpy array`, `PyTorch Tensor`,</span>
<span class="sd">    `float`, `int`, `bool`, `string` and `object` keep the original.</span>
<span class="sd">    If passing a dictionary, list or tuple, still return dictionary, list or tuple and recursively convert</span>
<span class="sd">    every item to the expected data type.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_type: target data type to convert, should be &quot;tensor&quot; or &quot;numpy&quot;.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;tensor&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="n">data_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">data_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;tensor&quot;</span><span class="p">,</span> <span class="s2">&quot;numpy&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`data type` must be &#39;tensor&#39; or &#39;numpy&#39;.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data_type</span> <span class="o">=</span> <span class="n">data_type</span>

<div class="viewcode-block" id="EnsureType.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.EnsureType.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            data: input data can be PyTorch Tensor, numpy array, list, dictionary, int, float, bool, str, etc.</span>
<span class="sd">                will ensure Tensor, Numpy array, float, int, bool as Tensors or numpy arrays, strings and</span>
<span class="sd">                objects keep the original. for dictionay, list or tuple, ensure every item as expected type</span>
<span class="sd">                if applicable.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">convert_to_tensor</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_type</span> <span class="o">==</span> <span class="s2">&quot;tensor&quot;</span> <span class="k">else</span> <span class="n">convert_to_numpy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ToNumpy"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.ToNumpy">[docs]</a><span class="k">class</span> <span class="nc">ToNumpy</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the input data to numpy array, can support list or tuple of numbers and PyTorch Tensor.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ToNumpy.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.ToNumpy.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the transform to `img` and make it contiguous.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">has_cp</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cp_ndarray</span><span class="p">):</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

        <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">array</span></div></div>


<div class="viewcode-block" id="ToCupy"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.ToCupy">[docs]</a><span class="k">class</span> <span class="nc">ToCupy</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the input data to CuPy array, can support list or tuple of numbers, NumPy and PyTorch Tensor.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ToCupy.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.ToCupy.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the transform to `img` and make it contiguous.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">cp</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">img</span><span class="p">))</span></div></div>


<span class="k">class</span> <span class="nc">ToPIL</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the input image (in the form of NumPy array or PyTorch Tensor) to PIL image</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the transform to `img`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">PILImageImage</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">img</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pil_image_fromarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>


<div class="viewcode-block" id="Transpose"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.Transpose">[docs]</a><span class="k">class</span> <span class="nc">Transpose</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transposes the input image based on the given `indices` dimension ordering.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">indices</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>

<div class="viewcode-block" id="Transpose.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.Transpose.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the transform to `img`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">)</span>  <span class="c1"># type: ignore</span></div></div>


<div class="viewcode-block" id="SqueezeDim"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.SqueezeDim">[docs]</a><span class="k">class</span> <span class="nc">SqueezeDim</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Squeeze a unitary dimension.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="SqueezeDim.__init__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.SqueezeDim.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            dim: dimension to be squeezed. Default = 0</span>
<span class="sd">                &quot;None&quot; works when the input is numpy array.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When ``dim`` is not an ``Optional[int]``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dim must be None or a int but is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dim</span></div>

<div class="viewcode-block" id="SqueezeDim.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.SqueezeDim.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">NdarrayTensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NdarrayTensor</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            img: numpy arrays with required dimension `dim` removed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">img</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>  <span class="c1"># type: ignore</span></div></div>


<div class="viewcode-block" id="DataStats"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.DataStats">[docs]</a><span class="k">class</span> <span class="nc">DataStats</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Utility transform to show the statistics of data for debug or analysis.</span>
<span class="sd">    It can be inserted into any place of a transform chain and check results of previous transforms.</span>
<span class="sd">    It support both `numpy.ndarray` and `torch.tensor` as input data,</span>
<span class="sd">    so it can be used in pre-processing and post-processing.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="DataStats.__init__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.DataStats.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Data&quot;</span><span class="p">,</span>
        <span class="n">data_type</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">data_shape</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">value_range</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">data_value</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">additional_info</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">logger_handler</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">Handler</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            prefix: will be printed in format: &quot;{prefix} statistics&quot;.</span>
<span class="sd">            data_type: whether to show the type of input data.</span>
<span class="sd">            data_shape: whether to show the shape of input data.</span>
<span class="sd">            value_range: whether to show the value range of input data.</span>
<span class="sd">            data_value: whether to show the raw value of input data.</span>
<span class="sd">                a typical example is to print some properties of Nifti image: affine, pixdim, etc.</span>
<span class="sd">            additional_info: user can define callable function to extract additional info from input data.</span>
<span class="sd">            logger_handler: add additional handler to output data: save to file, etc.</span>
<span class="sd">                add existing python logging handlers: https://docs.python.org/3/library/logging.handlers.html</span>
<span class="sd">                the handler should have a logging level of at least `INFO`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When ``additional_info`` is not an ``Optional[Callable]``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s2">&quot;prefix must be a string.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_type</span> <span class="o">=</span> <span class="n">data_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_shape</span> <span class="o">=</span> <span class="n">data_shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value_range</span> <span class="o">=</span> <span class="n">value_range</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_value</span> <span class="o">=</span> <span class="n">data_value</span>
        <span class="k">if</span> <span class="n">additional_info</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">additional_info</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;additional_info must be None or callable but is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">additional_info</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">additional_info</span> <span class="o">=</span> <span class="n">additional_info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logger_name</span> <span class="o">=</span> <span class="s2">&quot;DataStats&quot;</span>
        <span class="n">_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logger_name</span><span class="p">)</span>
        <span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
        <span class="n">console</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>  <span class="c1"># always stdout</span>
        <span class="n">console</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
        <span class="n">_logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">console</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">logger_handler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logger_handler</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataStats.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.DataStats.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">img</span><span class="p">:</span> <span class="n">NdarrayTensor</span><span class="p">,</span>
        <span class="n">prefix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">data_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">data_shape</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">value_range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">data_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">additional_info</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NdarrayTensor</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the transform to `img`, optionally take arguments similar to the class constructor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefix</span><span class="si">}</span><span class="s2"> statistics:&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_type</span> <span class="k">if</span> <span class="n">data_type</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">data_type</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_shape</span> <span class="k">if</span> <span class="n">data_shape</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">data_shape</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape: </span><span class="si">{</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_range</span> <span class="k">if</span> <span class="n">value_range</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">value_range</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value range: (</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value range: (</span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value range: (not a PyTorch or Numpy array, type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_value</span> <span class="k">if</span> <span class="n">data_value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">data_value</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value: </span><span class="si">{</span><span class="n">img</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">additional_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">additional_info</span> <span class="k">if</span> <span class="n">additional_info</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">additional_info</span>
        <span class="k">if</span> <span class="n">additional_info</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Additional info: </span><span class="si">{</span><span class="n">additional_info</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">separator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logger_name</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">img</span></div></div>


<div class="viewcode-block" id="SimulateDelay"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.SimulateDelay">[docs]</a><span class="k">class</span> <span class="nc">SimulateDelay</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a pass through transform to be used for testing purposes. It allows</span>
<span class="sd">    adding fake behaviors that are useful for testing purposes to simulate</span>
<span class="sd">    how large datasets behave without needing to test on large data sets.</span>

<span class="sd">    For example, simulating slow NFS data transfers, or slow network transfers</span>
<span class="sd">    in testing by adding explicit timing delays. Testing of small test data</span>
<span class="sd">    can lead to incomplete understanding of real world issues, and may lead</span>
<span class="sd">    to sub-optimal design choices.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="SimulateDelay.__init__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.SimulateDelay.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delay_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            delay_time: The minimum amount of time, in fractions of seconds,</span>
<span class="sd">                to accomplish this delay task.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delay_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">delay_time</span></div>

<div class="viewcode-block" id="SimulateDelay.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.SimulateDelay.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">NdarrayTensor</span><span class="p">,</span> <span class="n">delay_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NdarrayTensor</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            img: data remain unchanged throughout this transform.</span>
<span class="sd">            delay_time: The minimum amount of time, in fractions of seconds,</span>
<span class="sd">                to accomplish this delay task.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delay_time</span> <span class="k">if</span> <span class="n">delay_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">delay_time</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">img</span></div></div>


<div class="viewcode-block" id="Lambda"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.Lambda">[docs]</a><span class="k">class</span> <span class="nc">Lambda</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply a user-defined lambda as a transform.</span>

<span class="sd">    For example:</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :emphasize-lines: 2</span>

<span class="sd">        image = np.ones((10, 2, 2))</span>
<span class="sd">        lambd = Lambda(func=lambda x: x[:4, :, :])</span>
<span class="sd">        print(lambd(image).shape)</span>
<span class="sd">        (4, 2, 2)</span>

<span class="sd">    Args:</span>
<span class="sd">        func: Lambda/function to be applied.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: When ``func`` is not an ``Optional[Callable]``.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;func must be None or callable but is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">func</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span>

<div class="viewcode-block" id="Lambda.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.Lambda.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply `self.func` to `img`.</span>

<span class="sd">        Args:</span>
<span class="sd">            func: Lambda/function to be applied. Defaults to `self.func`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When ``func`` is not an ``Optional[Callable]``.</span>
<span class="sd">            ValueError: When ``func=None`` and ``self.func=None``. Incompatible values.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;func must be None or callable but is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">func</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Incompatible values: func=None and self.func=None.&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="LabelToMask"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.LabelToMask">[docs]</a><span class="k">class</span> <span class="nc">LabelToMask</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert labels to mask for other tasks. A typical usage is to convert segmentation labels</span>
<span class="sd">    to mask data to pre-process images and then feed the images into classification network.</span>
<span class="sd">    It can support single channel labels or One-Hot labels with specified `select_labels`.</span>
<span class="sd">    For example, users can select `label value = [2, 3]` to construct mask data, or select the</span>
<span class="sd">    second and the third channels of labels to construct mask data.</span>
<span class="sd">    The output mask data can be a multiple channels binary data or a single channel binary</span>
<span class="sd">    data that merges all the channels.</span>

<span class="sd">    Args:</span>
<span class="sd">        select_labels: labels to generate mask from. for 1 channel label, the `select_labels`</span>
<span class="sd">            is the expected label values, like: [1, 2, 3]. for One-Hot format label, the</span>
<span class="sd">            `select_labels` is the expected channel indices.</span>
<span class="sd">        merge_channels: whether to use `np.any()` to merge the result on channel dim. if yes,</span>
<span class="sd">            will return a single channel mask with binary data.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>  <span class="c1"># pytype: disable=annotation-type-mismatch</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">select_labels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">],</span>
        <span class="n">merge_channels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pytype: disable=annotation-type-mismatch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">select_labels</span> <span class="o">=</span> <span class="n">ensure_tuple</span><span class="p">(</span><span class="n">select_labels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">merge_channels</span> <span class="o">=</span> <span class="n">merge_channels</span>

<div class="viewcode-block" id="LabelToMask.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.LabelToMask.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">select_labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">merge_channels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            select_labels: labels to generate mask from. for 1 channel label, the `select_labels`</span>
<span class="sd">                is the expected label values, like: [1, 2, 3]. for One-Hot format label, the</span>
<span class="sd">                `select_labels` is the expected channel indices.</span>
<span class="sd">            merge_channels: whether to use `np.any()` to merge the result on channel dim. if yes,</span>
<span class="sd">                will return a single channel mask with binary data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">select_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">select_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_labels</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">select_labels</span> <span class="o">=</span> <span class="n">ensure_tuple</span><span class="p">(</span><span class="n">select_labels</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">img</span><span class="p">[[</span><span class="o">*</span><span class="n">select_labels</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">in1d</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">select_labels</span><span class="p">),</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">merge_channels</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">merge_channels</span><span class="p">)</span> <span class="k">else</span> <span class="n">data</span></div></div>


<div class="viewcode-block" id="FgBgToIndices"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.FgBgToIndices">[docs]</a><span class="k">class</span> <span class="nc">FgBgToIndices</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
<div class="viewcode-block" id="FgBgToIndices.__init__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.FgBgToIndices.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">output_shape</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute foreground and background of the input label data, return the indices.</span>
<span class="sd">        If no output_shape specified, output data will be 1 dim indices after flattening.</span>
<span class="sd">        This transform can help pre-compute foreground and background regions for other transforms.</span>
<span class="sd">        A typical usage is to randomly select foreground and background to crop.</span>
<span class="sd">        The main logic is based on :py:class:`monai.transforms.utils.map_binary_to_indices`.</span>

<span class="sd">        Args:</span>
<span class="sd">            image_threshold: if enabled `image` at runtime, use ``image &gt; image_threshold`` to</span>
<span class="sd">                determine the valid image content area and select background only in this area.</span>
<span class="sd">            output_shape: expected shape of output indices. if not None, unravel indices to specified shape.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image_threshold</span> <span class="o">=</span> <span class="n">image_threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_shape</span> <span class="o">=</span> <span class="n">output_shape</span></div>

<div class="viewcode-block" id="FgBgToIndices.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.FgBgToIndices.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">image</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">output_shape</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            label: input data to compute foreground and background indices.</span>
<span class="sd">            image: if image is not None, use ``label = 0 &amp; image &gt; image_threshold``</span>
<span class="sd">                to define background. so the output items will not map to all the voxels in the label.</span>
<span class="sd">            output_shape: expected shape of output indices. if None, use `self.output_shape` instead.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">output_shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_shape</span>
        <span class="n">fg_indices</span><span class="p">,</span> <span class="n">bg_indices</span> <span class="o">=</span> <span class="n">map_binary_to_indices</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_threshold</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output_shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fg_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">output_shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">fg_indices</span><span class="p">])</span>
            <span class="n">bg_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">output_shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">bg_indices</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">fg_indices</span><span class="p">,</span> <span class="n">bg_indices</span></div></div>


<div class="viewcode-block" id="ConvertToMultiChannelBasedOnBratsClasses"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.ConvertToMultiChannelBasedOnBratsClasses">[docs]</a><span class="k">class</span> <span class="nc">ConvertToMultiChannelBasedOnBratsClasses</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert labels to multi channels based on brats18 classes:</span>
<span class="sd">    label 1 is the necrotic and non-enhancing tumor core</span>
<span class="sd">    label 2 is the the peritumoral edema</span>
<span class="sd">    label 4 is the GD-enhancing tumor</span>
<span class="sd">    The possible classes are TC (Tumor core), WT (Whole tumor)</span>
<span class="sd">    and ET (Enhancing tumor).</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ConvertToMultiChannelBasedOnBratsClasses.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.ConvertToMultiChannelBasedOnBratsClasses.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="c1"># if img has channel dim, squeeze it</span>
        <span class="k">if</span> <span class="n">img</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># merge labels 1 (tumor non-enh) and 4 (tumor enh) to TC</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">img</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">img</span> <span class="o">==</span> <span class="mi">4</span><span class="p">))</span>
        <span class="c1"># merge labels 1 (tumor non-enh) and 4 (tumor enh) and 2 (large edema) to WT</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">img</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">img</span> <span class="o">==</span> <span class="mi">4</span><span class="p">),</span> <span class="n">img</span> <span class="o">==</span> <span class="mi">2</span><span class="p">))</span>
        <span class="c1"># label 4 is ET</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="AddExtremePointsChannel"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.AddExtremePointsChannel">[docs]</a><span class="k">class</span> <span class="nc">AddExtremePointsChannel</span><span class="p">(</span><span class="n">Randomizable</span><span class="p">,</span> <span class="n">Transform</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add extreme points of label to the image as a new channel. This transform generates extreme</span>
<span class="sd">    point from label and applies a gaussian filter. The pixel values in points image are rescaled</span>
<span class="sd">    to range [rescale_min, rescale_max] and added as a new channel to input image. The algorithm is</span>
<span class="sd">    described in Roth et al., Going to Extremes: Weakly Supervised Medical Image Segmentation</span>
<span class="sd">    https://arxiv.org/abs/2009.11988.</span>

<span class="sd">    This transform only supports single channel labels (1, spatial_dim1, [spatial_dim2, ...]). The</span>
<span class="sd">    background ``index`` is ignored when calculating extreme points.</span>

<span class="sd">    Args:</span>
<span class="sd">        background: Class index of background label, defaults to 0.</span>
<span class="sd">        pert: Random perturbation amount to add to the points, defaults to 0.0.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: When no label image provided.</span>
<span class="sd">        ValueError: When label image is not single channel.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">background</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pert</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_background</span> <span class="o">=</span> <span class="n">background</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pert</span> <span class="o">=</span> <span class="n">pert</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>

<div class="viewcode-block" id="AddExtremePointsChannel.randomize"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.AddExtremePointsChannel.randomize">[docs]</a>    <span class="k">def</span> <span class="nf">randomize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">get_extreme_points</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">rand_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_background</span><span class="p">,</span> <span class="n">pert</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_pert</span><span class="p">)</span></div>

<div class="viewcode-block" id="AddExtremePointsChannel.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.AddExtremePointsChannel.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">img</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sigma</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span>
        <span class="n">rescale_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">rescale_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            img: the image that we want to add new channel to.</span>
<span class="sd">            label: label image to get extreme points from. Shape must be</span>
<span class="sd">                (1, spatial_dim1, [, spatial_dim2, ...]). Doesn&#39;t support one-hot labels.</span>
<span class="sd">            sigma: if a list of values, must match the count of spatial dimensions of input data,</span>
<span class="sd">                and apply every value in the list to 1 spatial dimension. if only 1 value provided,</span>
<span class="sd">                use it for all spatial dimensions.</span>
<span class="sd">            rescale_min: minimum value of output data.</span>
<span class="sd">            rescale_max: maximum value of output data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This transform requires a label array!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">label</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only supports single channel labels!&quot;</span><span class="p">)</span>

        <span class="c1"># Generate extreme points</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>

        <span class="n">points_image</span> <span class="o">=</span> <span class="n">extreme_points_to_image</span><span class="p">(</span>
            <span class="n">points</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">rescale_min</span><span class="o">=</span><span class="n">rescale_min</span><span class="p">,</span> <span class="n">rescale_max</span><span class="o">=</span><span class="n">rescale_max</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">img</span><span class="p">,</span> <span class="n">points_image</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="TorchVision"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.TorchVision">[docs]</a><span class="k">class</span> <span class="nc">TorchVision</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a wrapper transform for PyTorch TorchVision transform based on the specified transform name and args.</span>
<span class="sd">    As most of the TorchVision transforms only work for PIL image and PyTorch Tensor, this transform expects input</span>
<span class="sd">    data to be PyTorch Tensor, users can easily call `ToTensor` transform to convert a Numpy array to Tensor.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="TorchVision.__init__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.TorchVision.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            name: The transform name in TorchVision package.</span>
<span class="sd">            args: parameters for the TorchVision transform.</span>
<span class="sd">            kwargs: parameters for the TorchVision transform.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">transform</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">optional_import</span><span class="p">(</span><span class="s2">&quot;torchvision.transforms&quot;</span><span class="p">,</span> <span class="s2">&quot;0.8.0&quot;</span><span class="p">,</span> <span class="n">min_version</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trans</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="TorchVision.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.TorchVision.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            img: PyTorch Tensor data for the TorchVision transform.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">img</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="MapLabelValue"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.MapLabelValue">[docs]</a><span class="k">class</span> <span class="nc">MapLabelValue</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Utility to map label values to another set of values.</span>
<span class="sd">    For example, map [3, 2, 1] to [0, 1, 2], [1, 2, 3] -&gt; [0.5, 1.5, 2.5], [&quot;label3&quot;, &quot;label2&quot;, &quot;label1&quot;] -&gt; [0, 1, 2],</span>
<span class="sd">    [3.5, 2.5, 1.5] -&gt; [&quot;label0&quot;, &quot;label1&quot;, &quot;label2&quot;], etc.</span>
<span class="sd">    The label data must be numpy array or array-like data and the output data will be numpy array.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="MapLabelValue.__init__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.MapLabelValue.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orig_labels</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">target_labels</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">DtypeLike</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            orig_labels: original labels that map to others.</span>
<span class="sd">            target_labels: expected label values, 1: 1 map to the `orig_labels`.</span>
<span class="sd">            dtype: convert the output data to dtype, default to float32.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">orig_labels</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_labels</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;orig_labels and target_labels must have the same length.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">o</span> <span class="o">==</span> <span class="n">z</span> <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">orig_labels</span><span class="p">,</span> <span class="n">target_labels</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;orig_labels and target_labels are exactly the same, should be different to map.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">orig_labels</span> <span class="o">=</span> <span class="n">orig_labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_labels</span> <span class="o">=</span> <span class="n">target_labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span></div>

<div class="viewcode-block" id="MapLabelValue.__call__"><a class="viewcode-back" href="../../../../transforms.html#monai.transforms.MapLabelValue.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="n">img_flat</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">out_flat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">img_flat</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="c1"># can&#39;t copy unchanged labels as the expected dtype is not supported, must map all the label values</span>
            <span class="n">out_flat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">img_flat</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">orig_labels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_labels</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">o</span> <span class="o">==</span> <span class="n">t</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">np</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">out_flat</span><span class="p">,</span> <span class="n">img_flat</span> <span class="o">==</span> <span class="n">o</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out_flat</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span></div></div>
</pre></div>

              </div>
              
              
              <div class='prev-next-bottom'>
                

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2020 - 2021 MONAI Consortium.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>