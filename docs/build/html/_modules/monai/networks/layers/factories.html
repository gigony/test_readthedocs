
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>monai.networks.layers.factories &#8212; MONAI 0.6.0 Documentation</title>
    
  <link href="../../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css" />
    
  <link rel="preload" as="script" href="../../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../../../index.html">
  <img src="../../../../_static/MONAI-logo-color.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../whatsnew.html">
  Whatâ€™s New
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../highlights.html">
  Modules Overview
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../api.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../installation.html">
  Installation Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../contrib.html">
  Development
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/Project-MONAI/tutorials">Tutorials<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/project-monai/monai" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/projectmonai" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <h1>Source code for monai.networks.layers.factories</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2020 - 2021 MONAI Consortium</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Defines factories for creating layers in generic, extensible, and dimensionally independent ways. A separate factory</span>
<span class="sd">object is created for each type of layer, and factory functions keyed to names are added to these objects. Whenever</span>
<span class="sd">a layer is requested the factory name and any necessary arguments are passed to the factory object. The return value</span>
<span class="sd">is typically a type but can be any callable producing a layer object.</span>

<span class="sd">The factory objects contain functions keyed to names converted to upper case, these names can be referred to as members</span>
<span class="sd">of the factory so that they can function as constant identifiers. eg. instance normalization is named `Norm.INSTANCE`.</span>

<span class="sd">For example, to get a transpose convolution layer the name is needed and then a dimension argument is provided which is</span>
<span class="sd">passed to the factory function:</span>

<span class="sd">.. code-block:: python</span>

<span class="sd">    dimension = 3</span>
<span class="sd">    name = Conv.CONVTRANS</span>
<span class="sd">    conv = Conv[name, dimension]</span>

<span class="sd">This allows the `dimension` value to be set in the constructor, for example so that the dimensionality of a network is</span>
<span class="sd">parameterizable. Not all factories require arguments after the name, the caller must be aware which are required.</span>

<span class="sd">Defining new factories involves creating the object then associating it with factory functions:</span>

<span class="sd">.. code-block:: python</span>

<span class="sd">    fact = LayerFactory()</span>

<span class="sd">    @fact.factory_function(&#39;test&#39;)</span>
<span class="sd">    def make_something(x, y):</span>
<span class="sd">        # do something with x and y to choose which layer type to return</span>
<span class="sd">        return SomeLayerType</span>
<span class="sd">    ...</span>

<span class="sd">    # request object from factory TEST with 1 and 2 as values for x and y</span>
<span class="sd">    layer = fact[fact.TEST, 1, 2]</span>

<span class="sd">Typically the caller of a factory would know what arguments to pass (ie. the dimensionality of the requested type) but</span>
<span class="sd">can be parameterized with the factory name and the arguments to pass to the created type at instantiation time:</span>

<span class="sd">.. code-block:: python</span>

<span class="sd">    def use_factory(fact_args):</span>
<span class="sd">        fact_name, type_args = split_args</span>
<span class="sd">        layer_type = fact[fact_name, 1, 2]</span>
<span class="sd">        return layer_type(**type_args)</span>
<span class="sd">    ...</span>

<span class="sd">    kw_args = {&#39;arg0&#39;:0, &#39;arg1&#39;:True}</span>
<span class="sd">    layer = use_factory( (fact.TEST, kwargs) )</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;LayerFactory&quot;</span><span class="p">,</span> <span class="s2">&quot;Dropout&quot;</span><span class="p">,</span> <span class="s2">&quot;Norm&quot;</span><span class="p">,</span> <span class="s2">&quot;Act&quot;</span><span class="p">,</span> <span class="s2">&quot;Conv&quot;</span><span class="p">,</span> <span class="s2">&quot;Pool&quot;</span><span class="p">,</span> <span class="s2">&quot;Pad&quot;</span><span class="p">,</span> <span class="s2">&quot;split_args&quot;</span><span class="p">]</span>


<div class="viewcode-block" id="LayerFactory"><a class="viewcode-back" href="../../../../networks.html#monai.networks.layers.LayerFactory">[docs]</a><span class="k">class</span> <span class="nc">LayerFactory</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Factory object for creating layers, this uses given factory functions to actually produce the types or constructing</span>
<span class="sd">    callables. These functions are referred to by name and can be added at any time.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factories</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produces all factory names.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factories</span><span class="p">)</span>

<div class="viewcode-block" id="LayerFactory.add_factory_callable"><a class="viewcode-back" href="../../../../networks.html#monai.networks.layers.LayerFactory.add_factory_callable">[docs]</a>    <span class="k">def</span> <span class="nf">add_factory_callable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add the factory function to this object under the given name.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">factories</span><span class="p">[</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span> <span class="o">=</span> <span class="n">func</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;The supported member&quot;</span>
            <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;s are: &quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot; is: &quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;``</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">``&quot;</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;.</span><span class="se">\n</span><span class="s2">Please see :py:class:`monai.networks.layers.split_args` for additional args parsing.&quot;</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="LayerFactory.factory_function"><a class="viewcode-back" href="../../../../networks.html#monai.networks.layers.LayerFactory.factory_function">[docs]</a>    <span class="k">def</span> <span class="nf">factory_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Decorator for adding a factory function with the given name.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_add</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_factory_callable</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">func</span>

        <span class="k">return</span> <span class="n">_add</span></div>

<div class="viewcode-block" id="LayerFactory.get_constructor"><a class="viewcode-back" href="../../../../networks.html#monai.networks.layers.LayerFactory.get_constructor">[docs]</a>    <span class="k">def</span> <span class="nf">get_constructor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factory_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the constructor for the given factory name and arguments.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: When ``factory_name`` is not a ``str``.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">factory_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;factory_name must a str but is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">factory_name</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

        <span class="n">fact</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factories</span><span class="p">[</span><span class="n">factory_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">fact</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the given name or name/arguments pair. If `args` is a callable it is assumed to be the constructor</span>
<span class="sd">        itself and is returned, otherwise it should be the factory name or a pair containing the name and arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># `args[0]` is actually a type or constructor</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">args</span>

        <span class="c1"># `args` is a factory name or a name with arguments</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">name_obj</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="p">,</span> <span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name_obj</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_constructor</span><span class="p">(</span><span class="n">name_obj</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If `key` is a factory name, return it, otherwise behave as inherited. This allows referring to factory names</span>
<span class="sd">        as if they were constants, eg. `Fact.FOO` for a factory Fact with factory function foo.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">factories</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">key</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="split_args"><a class="viewcode-back" href="../../../../networks.html#monai.networks.layers.split_args">[docs]</a><span class="k">def</span> <span class="nf">split_args</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Split arguments in a way to be suitable for using with the factory types. If `args` is a string it&#39;s interpreted as</span>
<span class="sd">    the type name.</span>

<span class="sd">    Args:</span>
<span class="sd">        args (str or a tuple of object name and kwarg dict): input arguments to be parsed.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: When ``args`` type is not in ``Union[str, Tuple[Union[str, Callable], dict]]``.</span>

<span class="sd">    Examples::</span>

<span class="sd">        &gt;&gt;&gt; act_type, args = split_args(&quot;PRELU&quot;)</span>
<span class="sd">        &gt;&gt;&gt; monai.networks.layers.Act[act_type]</span>
<span class="sd">        &lt;class &#39;torch.nn.modules.activation.PReLU&#39;&gt;</span>

<span class="sd">        &gt;&gt;&gt; act_type, args = split_args((&quot;PRELU&quot;, {&quot;num_parameters&quot;: 1, &quot;init&quot;: 0.25}))</span>
<span class="sd">        &gt;&gt;&gt; monai.networks.layers.Act[act_type](**args)</span>
<span class="sd">        PReLU(num_parameters=1)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">args</span><span class="p">,</span> <span class="p">{}</span>
    <span class="n">name_obj</span><span class="p">,</span> <span class="n">name_args</span> <span class="o">=</span> <span class="n">args</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name_obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">))</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name_args</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Layer specifiers must be single strings or pairs of the form (name/object-types, argument dict)&quot;</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">name_obj</span><span class="p">,</span> <span class="n">name_args</span></div>


<span class="c1"># Define factories for these layer types</span>

<span class="n">Dropout</span> <span class="o">=</span> <span class="n">LayerFactory</span><span class="p">()</span>
<span class="n">Norm</span> <span class="o">=</span> <span class="n">LayerFactory</span><span class="p">()</span>
<span class="n">Act</span> <span class="o">=</span> <span class="n">LayerFactory</span><span class="p">()</span>
<span class="n">Conv</span> <span class="o">=</span> <span class="n">LayerFactory</span><span class="p">()</span>
<span class="n">Pool</span> <span class="o">=</span> <span class="n">LayerFactory</span><span class="p">()</span>
<span class="n">Pad</span> <span class="o">=</span> <span class="n">LayerFactory</span><span class="p">()</span>


<span class="nd">@Dropout</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;dropout&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">dropout_factory</span><span class="p">(</span><span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout3d</span><span class="p">]]:</span>
    <span class="n">types</span> <span class="o">=</span> <span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout3d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">types</span><span class="p">[</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>


<span class="nd">@Dropout</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;alphadropout&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">alpha_dropout_factory</span><span class="p">(</span><span class="n">_dim</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">AlphaDropout</span>


<span class="nd">@Norm</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;instance&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">instance_factory</span><span class="p">(</span><span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">InstanceNorm1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">InstanceNorm2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">InstanceNorm3d</span><span class="p">]]:</span>
    <span class="n">types</span> <span class="o">=</span> <span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">InstanceNorm1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">InstanceNorm2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">InstanceNorm3d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">types</span><span class="p">[</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>


<span class="nd">@Norm</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;batch&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">batch_factory</span><span class="p">(</span><span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm3d</span><span class="p">]]:</span>
    <span class="n">types</span> <span class="o">=</span> <span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm3d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">types</span><span class="p">[</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>


<span class="nd">@Norm</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">group_factory</span><span class="p">(</span><span class="n">_dim</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">GroupNorm</span><span class="p">]:</span>
    <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">GroupNorm</span>


<span class="nd">@Norm</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;layer&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">layer_factory</span><span class="p">(</span><span class="n">_dim</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">]:</span>
    <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span>


<span class="nd">@Norm</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;localresponse&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">local_response_factory</span><span class="p">(</span><span class="n">_dim</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">LocalResponseNorm</span><span class="p">]:</span>
    <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">LocalResponseNorm</span>


<span class="nd">@Norm</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;syncbatch&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">sync_batch_factory</span><span class="p">(</span><span class="n">_dim</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">SyncBatchNorm</span><span class="p">]:</span>
    <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">SyncBatchNorm</span>


<span class="n">Act</span><span class="o">.</span><span class="n">add_factory_callable</span><span class="p">(</span><span class="s2">&quot;elu&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">ELU</span><span class="p">)</span>
<span class="n">Act</span><span class="o">.</span><span class="n">add_factory_callable</span><span class="p">(</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">ReLU</span><span class="p">)</span>
<span class="n">Act</span><span class="o">.</span><span class="n">add_factory_callable</span><span class="p">(</span><span class="s2">&quot;leakyrelu&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">)</span>
<span class="n">Act</span><span class="o">.</span><span class="n">add_factory_callable</span><span class="p">(</span><span class="s2">&quot;prelu&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">PReLU</span><span class="p">)</span>
<span class="n">Act</span><span class="o">.</span><span class="n">add_factory_callable</span><span class="p">(</span><span class="s2">&quot;relu6&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">ReLU6</span><span class="p">)</span>
<span class="n">Act</span><span class="o">.</span><span class="n">add_factory_callable</span><span class="p">(</span><span class="s2">&quot;selu&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">SELU</span><span class="p">)</span>
<span class="n">Act</span><span class="o">.</span><span class="n">add_factory_callable</span><span class="p">(</span><span class="s2">&quot;celu&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">CELU</span><span class="p">)</span>
<span class="n">Act</span><span class="o">.</span><span class="n">add_factory_callable</span><span class="p">(</span><span class="s2">&quot;gelu&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">GELU</span><span class="p">)</span>
<span class="n">Act</span><span class="o">.</span><span class="n">add_factory_callable</span><span class="p">(</span><span class="s2">&quot;sigmoid&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">)</span>
<span class="n">Act</span><span class="o">.</span><span class="n">add_factory_callable</span><span class="p">(</span><span class="s2">&quot;tanh&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">Tanh</span><span class="p">)</span>
<span class="n">Act</span><span class="o">.</span><span class="n">add_factory_callable</span><span class="p">(</span><span class="s2">&quot;softmax&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">Softmax</span><span class="p">)</span>
<span class="n">Act</span><span class="o">.</span><span class="n">add_factory_callable</span><span class="p">(</span><span class="s2">&quot;logsoftmax&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">LogSoftmax</span><span class="p">)</span>


<span class="nd">@Act</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;swish&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">swish_factory</span><span class="p">():</span>
    <span class="kn">from</span> <span class="nn">monai.networks.blocks.activation</span> <span class="kn">import</span> <span class="n">Swish</span>

    <span class="k">return</span> <span class="n">Swish</span>


<span class="nd">@Act</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;memswish&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">memswish_factory</span><span class="p">():</span>
    <span class="kn">from</span> <span class="nn">monai.networks.blocks.activation</span> <span class="kn">import</span> <span class="n">MemoryEfficientSwish</span>

    <span class="k">return</span> <span class="n">MemoryEfficientSwish</span>


<span class="nd">@Act</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;mish&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">mish_factory</span><span class="p">():</span>
    <span class="kn">from</span> <span class="nn">monai.networks.blocks.activation</span> <span class="kn">import</span> <span class="n">Mish</span>

    <span class="k">return</span> <span class="n">Mish</span>


<span class="nd">@Conv</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;conv&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">conv_factory</span><span class="p">(</span><span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Conv1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">]]:</span>
    <span class="n">types</span> <span class="o">=</span> <span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Conv1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">types</span><span class="p">[</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>


<span class="nd">@Conv</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;convtrans&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">convtrans_factory</span><span class="p">(</span><span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">ConvTranspose1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">ConvTranspose2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">ConvTranspose3d</span><span class="p">]]:</span>
    <span class="n">types</span> <span class="o">=</span> <span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">ConvTranspose1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">ConvTranspose2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">ConvTranspose3d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">types</span><span class="p">[</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>


<span class="nd">@Pool</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;max&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">maxpooling_factory</span><span class="p">(</span><span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">MaxPool1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool3d</span><span class="p">]]:</span>
    <span class="n">types</span> <span class="o">=</span> <span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">MaxPool1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool3d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">types</span><span class="p">[</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>


<span class="nd">@Pool</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;adaptivemax&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">adaptive_maxpooling_factory</span><span class="p">(</span>
    <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">AdaptiveMaxPool1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">AdaptiveMaxPool2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">AdaptiveMaxPool3d</span><span class="p">]]:</span>
    <span class="n">types</span> <span class="o">=</span> <span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">AdaptiveMaxPool1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">AdaptiveMaxPool2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">AdaptiveMaxPool3d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">types</span><span class="p">[</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>


<span class="nd">@Pool</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;avg&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">avgpooling_factory</span><span class="p">(</span><span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">AvgPool1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">AvgPool2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">AvgPool3d</span><span class="p">]]:</span>
    <span class="n">types</span> <span class="o">=</span> <span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">AvgPool1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">AvgPool2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">AvgPool3d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">types</span><span class="p">[</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>


<span class="nd">@Pool</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;adaptiveavg&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">adaptive_avgpooling_factory</span><span class="p">(</span>
    <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">AdaptiveAvgPool1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">AdaptiveAvgPool2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">AdaptiveAvgPool3d</span><span class="p">]]:</span>
    <span class="n">types</span> <span class="o">=</span> <span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">AdaptiveAvgPool1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">AdaptiveAvgPool2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">AdaptiveAvgPool3d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">types</span><span class="p">[</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>


<span class="nd">@Pad</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;replicationpad&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">replication_pad_factory</span><span class="p">(</span><span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">ReplicationPad1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReplicationPad2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReplicationPad3d</span><span class="p">]]:</span>
    <span class="n">types</span> <span class="o">=</span> <span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">ReplicationPad1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReplicationPad2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReplicationPad3d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">types</span><span class="p">[</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>


<span class="nd">@Pad</span><span class="o">.</span><span class="n">factory_function</span><span class="p">(</span><span class="s2">&quot;constantpad&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">constant_pad_factory</span><span class="p">(</span><span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">ConstantPad1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">ConstantPad2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">ConstantPad3d</span><span class="p">]]:</span>
    <span class="n">types</span> <span class="o">=</span> <span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">ConstantPad1d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">ConstantPad2d</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">ConstantPad3d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">types</span><span class="p">[</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>

              </div>
              
              
              <div class='prev-next-bottom'>
                

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2020 - 2021 MONAI Consortium.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>